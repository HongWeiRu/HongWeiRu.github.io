<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>貨架管理 - 平面圖導航</title>
    <style>
      /* ===== 基本樣式重置 ===== */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display",
          "Helvetica Neue", sans-serif;
        background: #f8fafb;
        overflow-x: hidden;
      }

      /* ===== 頂部導航 ===== */
      .header {
        background: linear-gradient(135deg, #2d5a4a 0%, #1e3a33 100%);
        color: white;
        padding: 20px 32px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 2px 20px rgba(0, 0, 0, 0.12);
        height: 88px;
        position: relative;
        z-index: 1000;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 16px;
        font-size: 24px;
        font-weight: 600;
      }

      .logo-icon {
        width: 40px;
        height: 40px;
        background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 20px;
      }

      .header-center {
        display: flex;
        align-items: center;
        gap: 24px;
      }

      .breadcrumb {
        display: flex;
        align-items: center;
        gap: 8px;
        color: rgba(255, 255, 255, 0.8);
        font-size: 14px;
      }

      .breadcrumb-item {
        cursor: pointer;
        transition: color 0.2s;
      }

      .breadcrumb-item:hover {
        color: #4ade80;
      }

      .breadcrumb-item.active {
        color: white;
        font-weight: 600;
      }

      .user-info {
        display: flex;
        align-items: center;
        gap: 12px;
        background: rgba(255, 255, 255, 0.1);
        padding: 12px 16px;
        border-radius: 12px;
        backdrop-filter: blur(10px);
      }

      .user-avatar {
        width: 36px;
        height: 36px;
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: bold;
        color: white;
      }

      /* ===== 主要內容 ===== */
      .content {
        padding: 32px;
        min-height: calc(100vh - 88px);
      }

      /* ===== 平面圖視圖 ===== */
      .floorplan-view {
        display: block;
      }

      .floorplan-view.hidden {
        display: none;
      }

      .page-header {
        margin-bottom: 32px;
      }

      .page-title {
        font-size: 36px;
        font-weight: 700;
        color: #1f2937;
        margin-bottom: 8px;
      }

      .page-subtitle {
        color: #6b7280;
        font-size: 18px;
        font-weight: 400;
      }

      /* ===== 視圖控制工具列 ===== */
      .view-controls {
        background: white;
        border-radius: 16px;
        padding: 20px 24px;
        margin-bottom: 24px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 16px;
      }

      .view-options {
        display: flex;
        gap: 16px;
        align-items: center;
      }

      .view-toggle {
        display: flex;
        background: #f3f4f6;
        border-radius: 12px;
        padding: 6px;
      }

      .toggle-btn {
        padding: 10px 20px;
        border: none;
        background: transparent;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
        white-space: nowrap;
      }

      .toggle-btn.active {
        background: white;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        color: #1f2937;
      }

      .legend {
        display: flex;
        gap: 20px;
        align-items: center;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        color: #6b7280;
      }

      .legend-color {
        width: 16px;
        height: 16px;
        border-radius: 4px;
      }

      .legend-color.active {
        background: #10b981;
      }
      .legend-color.warning {
        background: #f59e0b;
      }
      .legend-color.error {
        background: #ef4444;
      }
      .legend-color.maintenance {
        background: #8b5cf6;
      }

      /* ===== 平面圖容器 ===== */
      .floorplan-container {
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        position: relative;
        overflow: hidden;
      }

      .floorplan-map {
        position: relative;
        width: 100%;
        max-width: 1000px;
        margin: 0 auto;
        aspect-ratio: 4/3;
        background: #f8fafc;
        border: 2px solid #e5e7eb;
        border-radius: 12px;
        overflow: hidden;
      }

      /* ===== 商店區域 ===== */
      .store-areas {
        position: relative;
        width: 100%;
        height: 100%;
      }

      /* A區 - 廚房用品 */
      .area-a {
        position: absolute;
        right: 10%;
        top: 20%;
        width: 25%;
        height: 35%;
        background: rgba(16, 185, 129, 0.1);
        border: 2px solid #10b981;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
      }

      /* B區 - 居家生活 */
      .area-b {
        position: absolute;
        right: 40%;
        top: 10%;
        width: 30%;
        height: 25%;
        background: rgba(59, 130, 246, 0.1);
        border: 2px solid #3b82f6;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
      }

      /* C區 - 旅遊用品 */
      .area-c {
        position: absolute;
        right: 40%;
        top: 40%;
        width: 20%;
        height: 20%;
        background: rgba(245, 158, 11, 0.1);
        border: 2px solid #f59e0b;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
      }

      /* D區 - 文具 */
      .area-d {
        position: absolute;
        left: 5%;
        top: 15%;
        width: 15%;
        height: 50%;
        background: rgba(139, 92, 246, 0.1);
        border: 2px solid #8b5cf6;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
      }

      /* E區 - 健康 */
      .area-e {
        position: absolute;
        left: 25%;
        bottom: 15%;
        width: 20%;
        height: 30%;
        background: rgba(34, 197, 94, 0.1);
        border: 2px solid #22c55e;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
      }

      /* F區 - 美妝 */
      .area-f {
        position: absolute;
        left: 5%;
        bottom: 10%;
        width: 15%;
        height: 25%;
        background: rgba(236, 72, 153, 0.1);
        border: 2px solid #ec4899;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
      }

      /* G區 - 授權IP */
      .area-g {
        position: absolute;
        right: 5%;
        bottom: 15%;
        width: 20%;
        height: 30%;
        background: rgba(14, 165, 233, 0.1);
        border: 2px solid #0ea5e9;
        border-radius: 8px;
        display: flex;
        flex-direction: column;
      }

      .area-label {
        background: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 8px 12px;
        font-size: 14px;
        font-weight: 600;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .area-content {
        flex: 1;
        padding: 16px 12px;
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        align-content: flex-start;
      }

      /* ===== 貨架熱點 ===== */
      .shelf-hotspot {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
        position: relative;
        border: 2px solid white;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 10px;
        font-weight: bold;
        color: white;
      }

      .shelf-hotspot.active {
        background: #10b981;
        animation: pulse-green 2s infinite;
      }

      .shelf-hotspot.warning {
        background: #f59e0b;
        animation: pulse-orange 2s infinite;
      }

      .shelf-hotspot.error {
        background: #ef4444;
        animation: pulse-red 2s infinite;
      }

      .shelf-hotspot.maintenance {
        background: #8b5cf6;
      }

      .shelf-hotspot:hover {
        transform: scale(1.5);
        z-index: 100;
      }

      @keyframes pulse-green {
        0%,
        100% {
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2),
            0 0 0 0 rgba(16, 185, 129, 0.7);
        }
        70% {
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2),
            0 0 0 10px rgba(16, 185, 129, 0);
        }
      }

      @keyframes pulse-orange {
        0%,
        100% {
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2),
            0 0 0 0 rgba(245, 158, 11, 0.7);
        }
        70% {
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2),
            0 0 0 10px rgba(245, 158, 11, 0);
        }
      }

      @keyframes pulse-red {
        0%,
        100% {
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2),
            0 0 0 0 rgba(239, 68, 68, 0.7);
        }
        70% {
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2),
            0 0 0 10px rgba(239, 68, 68, 0);
        }
      }

      /* ===== 貨架工具提示 ===== */
      .shelf-tooltip {
        position: absolute;
        background: rgba(0, 0, 0, 0.9);
        color: white;
        padding: 12px 16px;
        border-radius: 8px;
        font-size: 14px;
        white-space: nowrap;
        z-index: 200;
        opacity: 0;
        visibility: hidden;
        transition: all 0.2s;
        pointer-events: none;
      }

      .shelf-tooltip.show {
        opacity: 1;
        visibility: visible;
      }

      .shelf-tooltip::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        border: 5px solid transparent;
        border-top-color: rgba(0, 0, 0, 0.9);
      }

      /* ===== 統計總覽 ===== */
      .stats-overview {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-bottom: 32px;
      }

      .stat-card {
        background: white;
        padding: 24px;
        border-radius: 16px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        text-align: center;
        border-left: 4px solid;
      }

      .stat-card.total {
        border-left-color: #3b82f6;
      }
      .stat-card.active {
        border-left-color: #10b981;
      }
      .stat-card.warning {
        border-left-color: #f59e0b;
      }
      .stat-card.error {
        border-left-color: #ef4444;
      }

      .stat-number {
        font-size: 36px;
        font-weight: 800;
        color: #1f2937;
        margin-bottom: 8px;
      }

      .stat-label {
        color: #6b7280;
        font-size: 14px;
        font-weight: 600;
      }

      /* ===== 詳細貨架視圖 ===== */
      .shelf-detail-view {
        display: none;
      }

      .shelf-detail-view.active {
        display: block;
        animation: fadeIn 0.3s ease;
      }

      .detail-header {
        background: white;
        border-radius: 16px;
        padding: 24px;
        margin-bottom: 24px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .back-btn {
        background: #f3f4f6;
        border: none;
        padding: 12px 24px;
        border-radius: 12px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        color: #374151;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .back-btn:hover {
        background: #e5e7eb;
      }

      .shelf-info {
        flex: 1;
        margin: 0 24px;
      }

      .shelf-name {
        font-size: 24px;
        font-weight: 700;
        color: #1f2937;
        margin-bottom: 4px;
      }

      .shelf-location {
        color: #6b7280;
        font-size: 14px;
      }

      .shelf-actions {
        display: flex;
        gap: 12px;
      }

      .action-btn {
        padding: 10px 20px;
        border-radius: 10px;
        border: none;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
      }

      .action-btn.primary {
        background: #3b82f6;
        color: white;
      }

      .action-btn.success {
        background: #10b981;
        color: white;
      }

      .action-btn.warning {
        background: #f59e0b;
        color: white;
      }

      .shelf-visual-detail {
        background: white;
        border-radius: 16px;
        padding: 32px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
      }

      .shelf-rows {
        display: flex;
        flex-direction: column;
        gap: 16px;
        margin-bottom: 24px;
      }

      .shelf-row {
        display: flex;
        gap: 12px;
        align-items: center;
      }

      .row-label {
        width: 30px;
        font-size: 14px;
        font-weight: 600;
        color: #6b7280;
        text-align: center;
      }

      .product-slot {
        width: 60px;
        height: 80px;
        border-radius: 8px;
        border: 2px solid #d1d5db;
        transition: all 0.2s;
        cursor: pointer;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: 500;
        background-size: cover;
        background-position: center;
      }

      .product-slot:hover {
        transform: scale(1.05);
      }

      .product-slot.filled {
        background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
        border-color: #22c55e;
        color: white;
      }

      .product-slot.empty {
        background: #f9fafb;
        border-style: dashed;
        color: #9ca3af;
      }

      .product-slot.bestseller {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        border-color: #d97706;
        color: white;
      }

      .product-slot.low-stock {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        border-color: #dc2626;
        color: white;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* ===== 響應式設計 ===== */
      @media (max-width: 768px) {
        .header {
          padding: 16px 20px;
          height: 70px;
        }

        .content {
          padding: 20px;
        }

        .page-title {
          font-size: 28px;
        }

        .floorplan-map {
          aspect-ratio: 3/4;
        }

        .stats-overview {
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
        }

        .view-controls {
          flex-direction: column;
          align-items: stretch;
        }

        .legend {
          justify-content: center;
          flex-wrap: wrap;
        }

        .shelf-row {
          gap: 8px;
        }

        .product-slot {
          width: 40px;
          height: 60px;
          font-size: 10px;
        }
      }
    </style>
  </head>
  <body>
    <!-- 頂部導航 -->
    <header class="header">
      <div class="logo">
        <div class="logo-icon">S</div>
        <span>ShelfManager Pro</span>
      </div>
      <div class="header-center">
        <div class="breadcrumb">
          <span class="breadcrumb-item" onclick="showFloorplan()"
            >貨架管理</span
          >
          <span>›</span>
          <span class="breadcrumb-item active" id="currentView"
            >平面圖總覽</span
          >
        </div>
      </div>
      <div class="user-info">
        <div class="user-avatar">陳</div>
        <div>
          <div style="font-size: 16px; font-weight: 600">陳店長</div>
          <div style="font-size: 14px; opacity: 0.8">門市經理</div>
        </div>
      </div>
    </header>

    <main class="content">
      <!-- 平面圖視圖 -->
      <div class="floorplan-view" id="floorplanView">
        <div class="page-header">
          <h1 class="page-title">商店平面圖管理</h1>
          <p class="page-subtitle">
            點擊各區域貨架進入詳細管理，即時監控庫存狀態
          </p>
        </div>

        <!-- 統計總覽 -->
        <div class="stats-overview">
          <div class="stat-card total">
            <div class="stat-number">42</div>
            <div class="stat-label">總貨架數</div>
          </div>
          <div class="stat-card active">
            <div class="stat-number">35</div>
            <div class="stat-label">正常運作</div>
          </div>
          <div class="stat-card warning">
            <div class="stat-number">5</div>
            <div class="stat-label">庫存不足</div>
          </div>
          <div class="stat-card error">
            <div class="stat-number">2</div>
            <div class="stat-label">需要注意</div>
          </div>
        </div>

        <!-- 視圖控制 -->
        <div class="view-controls">
          <div class="view-options">
            <div class="view-toggle">
              <button class="toggle-btn active">即時狀態</button>
              <button class="toggle-btn">銷售熱力圖</button>
              <button class="toggle-btn">補貨規劃</button>
            </div>
          </div>
          <div class="legend">
            <div class="legend-item">
              <div class="legend-color active"></div>
              <span>正常運作</span>
            </div>
            <div class="legend-item">
              <div class="legend-color warning"></div>
              <span>庫存不足</span>
            </div>
            <div class="legend-item">
              <div class="legend-color error"></div>
              <span>需要補貨</span>
            </div>
            <div class="legend-item">
              <div class="legend-color maintenance"></div>
              <span>維護中</span>
            </div>
          </div>
        </div>

        <!-- 平面圖容器 -->
        <div class="floorplan-container">
          <div class="floorplan-map">
            <div class="store-areas">
              <!-- A區 - 廚房用品 -->
              <div class="area-a">
                <div class="area-label">
                  <span>🍽️</span>
                  <span>A區 廚房用品</span>
                </div>
                <div class="area-content">
                  <div
                    class="shelf-hotspot active"
                    data-shelf="A1"
                    onclick="showShelfDetail('A1', 'A區清潔用品貨架', '廚房清潔用品')"
                  >
                    1
                  </div>
                  <div
                    class="shelf-hotspot warning"
                    data-shelf="A2"
                    onclick="showShelfDetail('A2', 'A區廚具貨架', '烹飪廚具')"
                  >
                    2
                  </div>
                  <div
                    class="shelf-hotspot active"
                    data-shelf="A3"
                    onclick="showShelfDetail('A3', 'A區餐具貨架', '餐具用品')"
                  >
                    3
                  </div>
                  <div
                    class="shelf-hotspot error"
                    data-shelf="A4"
                    onclick="showShelfDetail('A4', 'A區調料貨架', '調味料')"
                  >
                    4
                  </div>
                  <div
                    class="shelf-hotspot active"
                    data-shelf="A5"
                    onclick="showShelfDetail('A5', 'A區食材貨架', '食材配料')"
                  >
                    5
                  </div>
                  <div
                    class="shelf-hotspot active"
                    data-shelf="A6"
                    onclick="showShelfDetail('A6', 'A區保鮮貨架', '保鮮用品')"
                  >
                    6
                  </div>
                </div>
              </div>

              <!-- B區 - 居家生活 -->
              <div class="area-b">
                <div class="area-label">
                  <span>🏠</span>
                  <span>B區 居家生活</span>
                </div>
                <div class="area-content">
                  <div
                    class="shelf-hotspot active"
                    data-shelf="B1"
                    onclick="showShelfDetail('B1', 'B區家具貨架', '居家家具')"
                  >
                    1
                  </div>
                  <div
                    class="shelf-hotspot active"
                    data-shelf="B2"
                    onclick="showShelfDetail('B2', 'B區裝飾貨架', '居家裝飾')"
                  >
                    2
                  </div>
                  <div
                    class="shelf-hotspot warning"
                    data-shelf="B3"
                    onclick="showShelfDetail('B3', 'B區織品貨架', '居家織品')"
                  >
                    3
                  </div>
                  <div
                    class="shelf-hotspot active"
                    data-shelf="B4"
                    onclick="showShelfDetail('B4', 'B區收納貨架', '收納用品')"
                  >
                    4
                  </div>
                </div>
              </div>

              <!-- C區 - 旅遊用品 -->
              <div class="area-c">
                <div class="area-label">
                  <span>✈️</span>
                  <span>C區 旅遊</span>
                </div>
                <div class="area-content">
                  <div
                    class="shelf-hotspot active"
                    data-shelf="C1"
                    onclick="showShelfDetail('C1', 'C區行李貨架', '旅行箱包')"
                  >
                    1
                  </div>
                  <div
                    class="shelf-hotspot warning"
                    data-shelf="C2"
                    onclick="showShelfDetail('C2', 'C區配件貨架', '旅遊配件')"
                  >
                    2
                  </div>
                </div>
              </div>

              <!-- D區 - 文具 -->
              <div class="area-d">
                <div class="area-label">
                  <span>📝</span>
                  <span>D區 文具</span>
                </div>
                <div class="area-content">
                  <div
                    class="shelf-hotspot active"
                    data-shelf="D1"
                    onclick="showShelfDetail('D1', 'D區書寫貨架', '書寫用品')"
                  >
                    1
                  </div>
                  <div
                    class="shelf-hotspot active"
                    data-shelf="D2"
                    onclick="showShelfDetail('D2', 'D區文件貨架', '文件用品')"
                  >
                    2
                  </div>
                  <div
                    class="shelf-hotspot error"
                    data-shelf="D3"
                    onclick="showShelfDetail('D3', 'D區美術貨架', '美術用品')"
                  >
                    3
                  </div>
                </div>
              </div>

              <!-- E區 - 健康 -->
              <div class="area-e">
                <div class="area-label">
                  <span>💊</span>
                  <span>E區 健康</span>
                </div>
                <div class="area-content">
                  <div
                    class="shelf-hotspot active"
                    data-shelf="E1"
                    onclick="showShelfDetail('E1', 'E區保健貨架', '保健食品')"
                  >
                    1
                  </div>
                  <div
                    class="shelf-hotspot warning"
                    data-shelf="E2"
                    onclick="showShelfDetail('E2', 'E區護理貨架', '護理用品')"
                  >
                    2
                  </div>
                </div>
              </div>

              <!-- F區 - 美妝 -->
              <div class="area-f">
                <div class="area-label">
                  <span>💄</span>
                  <span>F區 美妝</span>
                </div>
                <div class="area-content">
                  <div
                    class="shelf-hotspot active"
                    data-shelf="F1"
                    onclick="showShelfDetail('F1', 'F區化妝品貨架', '化妝品')"
                  >
                    1
                  </div>
                  <div
                    class="shelf-hotspot warning"
                    data-shelf="F2"
                    onclick="showShelfDetail('F2', 'F區護膚貨架', '護膚用品')"
                  >
                    2
                  </div>
                  <div
                    class="shelf-hotspot active"
                    data-shelf="F3"
                    onclick="showShelfDetail('F3', 'F區香水貨架', '香水香氛')"
                  >
                    3
                  </div>
                </div>
              </div>

              <!-- G區 - 授權IP -->
              <div class="area-g">
                <div class="area-label">
                  <span>🎮</span>
                  <span>G區 授權IP</span>
                </div>
                <div class="area-content">
                  <div
                    class="shelf-hotspot active"
                    data-shelf="G1"
                    onclick="showShelfDetail('G1', 'G區玩具貨架', '授權玩具')"
                  >
                    1
                  </div>
                  <div
                    class="shelf-hotspot active"
                    data-shelf="G2"
                    onclick="showShelfDetail('G2', 'G區周邊貨架', '周邊商品')"
                  >
                    2
                  </div>
                  <div
                    class="shelf-hotspot maintenance"
                    data-shelf="G3"
                    onclick="showShelfDetail('G3', 'G區限定貨架', '限定商品')"
                  >
                    3
                  </div>
                </div>
              </div>

              <!-- 中央通道和電梯區域 -->
              <div
                style="
                  position: absolute;
                  left: 45%;
                  top: 45%;
                  width: 10%;
                  height: 20%;
                  background: #e5e7eb;
                  border-radius: 8px;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                  color: #6b7280;
                  font-size: 24px;
                "
              >
                🛗
              </div>
            </div>
          </div>

          <!-- 工具提示 -->
          <div class="shelf-tooltip" id="shelfTooltip">
            <div id="tooltipContent"></div>
          </div>
        </div>
      </div>

      <!-- 詳細貨架視圖 -->
      <div class="shelf-detail-view" id="shelfDetailView">
        <div class="detail-header">
          <button class="back-btn" onclick="showFloorplan()">
            <span>←</span>
            <span>返回平面圖</span>
          </button>
          <div class="shelf-info">
            <div class="shelf-name" id="shelfDetailName">A區清潔用品貨架</div>
            <div class="shelf-location" id="shelfDetailLocation">
              位置：A區 | 類別：廚房清潔用品
            </div>
          </div>
          <div class="shelf-actions">
            <button class="action-btn primary">編輯佈局</button>
            <button class="action-btn success">補貨提醒</button>
            <button class="action-btn warning">維護模式</button>
          </div>
        </div>

        <div class="shelf-visual-detail">
          <h3 style="margin-bottom: 20px; color: #1f2937">貨架商品配置</h3>
          <div class="shelf-rows" id="shelfDetailRows">
            <!-- 動態生成貨架行 -->
          </div>

          <div
            style="
              margin-top: 32px;
              padding-top: 24px;
              border-top: 1px solid #e5e7eb;
            "
          >
            <div
              style="
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
              "
            >
              <div
                style="
                  background: #f8fafc;
                  padding: 16px;
                  border-radius: 12px;
                  text-align: center;
                "
              >
                <div
                  style="
                    font-size: 24px;
                    font-weight: 700;
                    color: #10b981;
                    margin-bottom: 4px;
                  "
                  id="detailUsage"
                >
                  85%
                </div>
                <div style="font-size: 14px; color: #6b7280">使用率</div>
              </div>
              <div
                style="
                  background: #f8fafc;
                  padding: 16px;
                  border-radius: 12px;
                  text-align: center;
                "
              >
                <div
                  style="
                    font-size: 24px;
                    font-weight: 700;
                    color: #f59e0b;
                    margin-bottom: 4px;
                  "
                  id="detailBestsellers"
                >
                  3
                </div>
                <div style="font-size: 14px; color: #6b7280">明星商品</div>
              </div>
              <div
                style="
                  background: #f8fafc;
                  padding: 16px;
                  border-radius: 12px;
                  text-align: center;
                "
              >
                <div
                  style="
                    font-size: 24px;
                    font-weight: 700;
                    color: #ef4444;
                    margin-bottom: 4px;
                  "
                  id="detailLowStock"
                >
                  2
                </div>
                <div style="font-size: 14px; color: #6b7280">庫存不足</div>
              </div>
              <div
                style="
                  background: #f8fafc;
                  padding: 16px;
                  border-radius: 12px;
                  text-align: center;
                "
              >
                <div
                  style="
                    font-size: 24px;
                    font-weight: 700;
                    color: #3b82f6;
                    margin-bottom: 4px;
                  "
                  id="detailRevenue"
                >
                  NT$15,240
                </div>
                <div style="font-size: 14px; color: #6b7280">本月營收</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script>
      // ===== 全域變數 =====
      let currentShelf = null;
      let shelfData = {
        A1: {
          name: "A區清潔用品貨架",
          category: "廚房清潔用品",
          usage: 89,
          bestsellers: 2,
          lowStock: 1,
          revenue: 12450,
        },
        A2: {
          name: "A區廚具貨架",
          category: "烹飪廚具",
          usage: 76,
          bestsellers: 3,
          lowStock: 2,
          revenue: 18230,
        },
        A3: {
          name: "A區餐具貨架",
          category: "餐具用品",
          usage: 92,
          bestsellers: 1,
          lowStock: 0,
          revenue: 9850,
        },
        A4: {
          name: "A區調料貨架",
          category: "調味料",
          usage: 45,
          bestsellers: 4,
          lowStock: 5,
          revenue: 25670,
        },
        A5: {
          name: "A區食材貨架",
          category: "食材配料",
          usage: 83,
          bestsellers: 2,
          lowStock: 1,
          revenue: 15240,
        },
        A6: {
          name: "A區保鮮貨架",
          category: "保鮮用品",
          usage: 78,
          bestsellers: 1,
          lowStock: 2,
          revenue: 11420,
        },
        B1: {
          name: "B區家具貨架",
          category: "居家家具",
          usage: 67,
          bestsellers: 1,
          lowStock: 0,
          revenue: 8940,
        },
        B2: {
          name: "B區裝飾貨架",
          category: "居家裝飾",
          usage: 85,
          bestsellers: 3,
          lowStock: 1,
          revenue: 16780,
        },
        B3: {
          name: "B區織品貨架",
          category: "居家織品",
          usage: 72,
          bestsellers: 2,
          lowStock: 3,
          revenue: 13560,
        },
        B4: {
          name: "B區收納貨架",
          category: "收納用品",
          usage: 91,
          bestsellers: 2,
          lowStock: 0,
          revenue: 19850,
        },
        C1: {
          name: "C區行李貨架",
          category: "旅行箱包",
          usage: 88,
          bestsellers: 1,
          lowStock: 1,
          revenue: 14230,
        },
        C2: {
          name: "C區配件貨架",
          category: "旅遊配件",
          usage: 73,
          bestsellers: 2,
          lowStock: 2,
          revenue: 10450,
        },
        D1: {
          name: "D區書寫貨架",
          category: "書寫用品",
          usage: 82,
          bestsellers: 3,
          lowStock: 1,
          revenue: 12890,
        },
        D2: {
          name: "D區文件貨架",
          category: "文件用品",
          usage: 79,
          bestsellers: 1,
          lowStock: 0,
          revenue: 8760,
        },
        D3: {
          name: "D區美術貨架",
          category: "美術用品",
          usage: 54,
          bestsellers: 2,
          lowStock: 4,
          revenue: 15670,
        },
        E1: {
          name: "E區保健貨架",
          category: "保健食品",
          usage: 86,
          bestsellers: 4,
          lowStock: 1,
          revenue: 22340,
        },
        E2: {
          name: "E區護理貨架",
          category: "護理用品",
          usage: 71,
          bestsellers: 2,
          lowStock: 3,
          revenue: 16780,
        },
        F1: {
          name: "F區化妝品貨架",
          category: "化妝品",
          usage: 93,
          bestsellers: 5,
          lowStock: 0,
          revenue: 28950,
        },
        F2: {
          name: "F區護膚貨架",
          category: "護膚用品",
          usage: 77,
          bestsellers: 3,
          lowStock: 2,
          revenue: 19560,
        },
        F3: {
          name: "F區香水貨架",
          category: "香水香氛",
          usage: 84,
          bestsellers: 2,
          lowStock: 1,
          revenue: 17890,
        },
        G1: {
          name: "G區玩具貨架",
          category: "授權玩具",
          usage: 89,
          bestsellers: 6,
          lowStock: 0,
          revenue: 24560,
        },
        G2: {
          name: "G區周邊貨架",
          category: "周邊商品",
          usage: 91,
          bestsellers: 4,
          lowStock: 1,
          revenue: 21340,
        },
        G3: {
          name: "G區限定貨架",
          category: "限定商品",
          usage: 0,
          bestsellers: 0,
          lowStock: 0,
          revenue: 0,
        },
      };

      // ===== 工具提示功能 =====
      function setupTooltips() {
        const hotspots = document.querySelectorAll(".shelf-hotspot");
        const tooltip = document.getElementById("shelfTooltip");

        hotspots.forEach((hotspot) => {
          hotspot.addEventListener("mouseenter", function (e) {
            const shelfId = this.dataset.shelf;
            const shelf = shelfData[shelfId];

            if (shelf) {
              const tooltipContent = `
                            <strong>${shelf.name}</strong><br>
                            使用率: ${shelf.usage}%<br>
                            明星商品: ${shelf.bestsellers}個<br>
                            庫存不足: ${shelf.lowStock}個
                        `;

              document.getElementById("tooltipContent").innerHTML =
                tooltipContent;

              const rect = this.getBoundingClientRect();
              const mapRect = document
                .querySelector(".floorplan-map")
                .getBoundingClientRect();

              tooltip.style.left =
                rect.left - mapRect.left + rect.width / 2 + "px";
              tooltip.style.top = rect.top - mapRect.top - 10 + "px";
              tooltip.classList.add("show");
            }
          });

          hotspot.addEventListener("mouseleave", function () {
            tooltip.classList.remove("show");
          });
        });
      }

      // ===== 顯示貨架詳細資訊 =====
      function showShelfDetail(shelfId, shelfName, category) {
        currentShelf = shelfId;
        const shelf = shelfData[shelfId];

        document.getElementById("floorplanView").classList.add("hidden");
        document.getElementById("shelfDetailView").classList.add("active");

        // 更新導航
        document.getElementById("currentView").textContent = shelfName;

        // 更新貨架資訊
        document.getElementById("shelfDetailName").textContent = shelfName;
        document.getElementById(
          "shelfDetailLocation"
        ).textContent = `位置：${shelfId.charAt(0)}區 | 類別：${category}`;

        // 更新統計數據
        document.getElementById("detailUsage").textContent = shelf.usage + "%";
        document.getElementById("detailBestsellers").textContent =
          shelf.bestsellers;
        document.getElementById("detailLowStock").textContent = shelf.lowStock;
        document.getElementById(
          "detailRevenue"
        ).textContent = `NT${shelf.revenue.toLocaleString()}`;

        // 生成貨架視覺化
        generateShelfLayout(shelfId);
      }

      // ===== 返回平面圖 =====
      function showFloorplan() {
        document.getElementById("floorplanView").classList.remove("hidden");
        document.getElementById("shelfDetailView").classList.remove("active");
        document.getElementById("currentView").textContent = "平面圖總覽";
        currentShelf = null;
      }

      // ===== 生成貨架佈局 =====
      function generateShelfLayout(shelfId) {
        const container = document.getElementById("shelfDetailRows");
        container.innerHTML = "";

        const shelf = shelfData[shelfId];
        const rows = 4; // 根據實際商店照片，大多是4層
        const cols = 8; // 每層8個商品位
        const rowLabels = ["頂層", "上層", "中層", "下層"];

        for (let r = 0; r < rows; r++) {
          const rowDiv = document.createElement("div");
          rowDiv.className = "shelf-row";

          const labelDiv = document.createElement("div");
          labelDiv.className = "row-label";
          labelDiv.textContent = rowLabels[r];
          rowDiv.appendChild(labelDiv);

          for (let c = 0; c < cols; c++) {
            const slotDiv = document.createElement("div");
            slotDiv.className = "product-slot";

            // 根據貨架狀態隨機分配商品狀態
            const random = Math.random();
            const emptyRate = (100 - shelf.usage) / 100;

            if (random < emptyRate) {
              slotDiv.classList.add("empty");
              slotDiv.textContent = "空";
            } else if (random < emptyRate + 0.15) {
              slotDiv.classList.add("bestseller");
              slotDiv.textContent = "★";
            } else if (random < emptyRate + 0.25) {
              slotDiv.classList.add("low-stock");
              slotDiv.textContent = "!";
            } else {
              slotDiv.classList.add("filled");
              slotDiv.textContent = "✓";
            }

            rowDiv.appendChild(slotDiv);
          }

          container.appendChild(rowDiv);
        }
      }

      // ===== 切換視圖模式 =====
      function switchViewMode(mode) {
        const buttons = document.querySelectorAll(".toggle-btn");
        buttons.forEach((btn) => btn.classList.remove("active"));
        event.target.classList.add("active");

        // 根據不同模式更新熱點顏色
        const hotspots = document.querySelectorAll(".shelf-hotspot");
        switch (mode) {
          case "即時狀態":
            // 保持現有狀態
            break;
          case "銷售熱力圖":
            hotspots.forEach((hotspot) => {
              const shelfId = hotspot.dataset.shelf;
              const shelf = shelfData[shelfId];
              if (shelf.revenue > 20000) {
                hotspot.className = "shelf-hotspot error"; // 高銷售用紅色
              } else if (shelf.revenue > 15000) {
                hotspot.className = "shelf-hotspot warning"; // 中銷售用橙色
              } else {
                hotspot.className = "shelf-hotspot active"; // 低銷售用綠色
              }
            });
            break;
          case "補貨規劃":
            hotspots.forEach((hotspot) => {
              const shelfId = hotspot.dataset.shelf;
              const shelf = shelfData[shelfId];
              if (shelf.lowStock > 3) {
                hotspot.className = "shelf-hotspot error";
              } else if (shelf.lowStock > 0) {
                hotspot.className = "shelf-hotspot warning";
              } else {
                hotspot.className = "shelf-hotspot active";
              }
            });
            break;
        }
      }

      // ===== 初始化 =====
      document.addEventListener("DOMContentLoaded", function () {
        setupTooltips();

        // 綁定切換按鈕事件
        const toggleBtns = document.querySelectorAll(".toggle-btn");
        toggleBtns.forEach((btn) => {
          btn.addEventListener("click", function () {
            switchViewMode(this.textContent);
          });
        });

        console.log("平面圖導航系統初始化完成");
      });
    </script>
  </body>
</html>
